# Взаимодействие сервисов
Кривопиша Сергей

Курс Software Architect

## Немного контекста
Это домашнее задание выполнено на основе ката, которая была использована и решена в предыдущем домашнем задании - ката Нила Форда, а именно Room with a View: https://nealford.com/katas/kata?id=RoomWithAView

[Домашнее задание #1 (Анализ требований и подготовка архитектурному решению)](homework_01.md)\
[Домашнее задание #2 (Декомпозиция на функциональные компоненты)](homework_02.md)

**Контекст**

Компания — крупный поставщик услуг по бронированию, стремящийся выйти на рынок премиум-класса, предлагая услуги для элитных курортов и спа-центров. Новый продукт, система бронирования и управления номерами, будет ориентирован на улучшение пользовательского опыта, предоставляя гостям удобный способ выбора номеров и усовершенствованные возможности для управления ресурсами отеля.

Система бронирования и управления номерами отеля включает в себя несколько ключевых сервисов, которые взаимодействуют друг с другом для обеспечения функциональности и улучшения пользовательского опыта. Важно, чтобы архитектура была гибкой, масштабируемой и легко модифицируемой, что позволяет адаптировать систему под будущие изменения и улучшения.

В данном случае мы рассмотрим взаимодействие между основными сервисами на основе выбранной декомпозиции по пользовательским потокам (Use Case).

### Основные сервисы и их взаимодействие

#### 1. **Сервис бронирования**
- **Основные функции**: поиск доступных номеров, выбор номеров, выбор дат, обработка платежей.
- **Взаимодействие с другими сервисами**:
  - **Сервис управления доступом**: Когда гость завершает процесс бронирования, сервис бронирования передает информацию о номере и сроках бронирования в сервис управления доступом для генерации виртуального ключа.
  - **Сервис уведомлений**: После успешного бронирования, сервис уведомлений отправляет гостю подтверждение бронирования.
  - **Сервис аналитики**: Информация о бронированиях поступает в сервис аналитики для формирования отчетов о загрузке номеров и трендах.
  
#### 2. **Сервис управления статусами номеров**
- **Основные функции**: обновление статусов номеров (доступен, занят, на уборке), планирование уборки, генерирование приоритетов для персонала.
- **Взаимодействие с другими сервисами**:
  - **Сервис бронирования**: Когда гость бронирует номер, статус этого номера меняется на «занят». После окончания срока бронирования статус меняется на «доступен».
  - **Сервис уведомлений**: Когда номер готов или требует уборки, сервис уведомлений сообщает персоналу о задачах.
  - **Сервис аналитики**: Данные о загрузке номеров и времени, затраченном на уборку, используются для анализа и оптимизации работы персонала.
  
#### 3. **Сервис управления доступом**
- **Основные функции**: генерация виртуальных ключей для гостей, интеграция с системой замков, обновление ключей при изменении бронирования.
- **Взаимодействие с другими сервисами**:
  - **Сервис бронирования**: При успешном бронировании сервис генерирует виртуальный ключ и отправляет его в интерфейс гостя.
  - **Сервис управления статусами номеров**: Когда номер становится доступным для нового гостя, система обновляет статус и сообщает сервису доступа для генерации нового ключа.
  - **Сервис уведомлений**: Уведомляет гостей о готовности их ключа, если нужно.
  
#### 4. **Сервис уведомлений**
- **Основные функции**: уведомления для гостей (статус бронирования, напоминания, рекомендации), уведомления для персонала (задачи, обновления статусов).
- **Взаимодействие с другими сервисами**:
  - **Сервис бронирования**: после завершения бронирования уведомление отправляется гостю с подтверждением и информацией.
  - **Сервис управления статусами номеров**: персонал уведомляется о задачах, например, уборке номеров или подготовки для нового гостя.
  - **Сервис аналитики**: в случае необходимости отправки уведомлений по определенным событиям, например, при наличии проблем с обслуживанием, система отправляет информацию для дальнейшего анализа и обработки.
  
#### 5. **Сервис аналитики**
- **Основные функции**: сбор и анализ данных о загрузке номеров, производительности персонала, отчетность.
- **Взаимодействие с другими сервисами**:
  - **Сервис бронирования**: данные о новых бронированиях используются для анализа загрузки номеров.
  - **Сервис управления статусами номеров**: статистика по состоянию номеров (например, время на уборку) поступает в сервис аналитики.
  - **Сервис уведомлений**: уведомления о проблемах или достижениях персонала (например, повышение эффективности уборки) также анализируются и могут использоваться для корректировки процессов.

### Оценка архитектурного решения

1. **Гибкость и модифицируемость**:
   - Декомпозиция на микросервисы позволяет легко вносить изменения и добавлять новые функции, такие как новые способы оплаты или расширенные возможности для персонализированных уведомлений.
   - Каждый сервис работает независимо, что уменьшает влияние изменений в одном сервисе на другие части системы. Это способствует гибкости при добавлении новых функций или изменении существующих.

2. **Масштабируемость**:
   - Все ключевые сервисы могут быть масштабированы независимо в зависимости от нагрузки. Например, сервис уведомлений может потребовать дополнительной мощности в праздничные дни или в случае пиковых нагрузок.
   - Взаимодействие между сервисами основано на стандартных API, что позволяет быстро адаптировать систему к изменяющимся требованиям бизнеса.

3. **Производительность**:
   - Архитектура с микросервисами гарантирует, что каждый сервис может быть оптимизирован для своих задач. Например, сервис бронирования будет работать с высокой производительностью, обрабатывая запросы пользователей, а сервис аналитики может быть оптимизирован для выполнения сложных вычислений в фоне.
   - При правильном распределении нагрузки между сервисами можно достичь высокой производительности системы в целом.

4. **Надежность**:
   - Микросервисная архитектура способствует высокой отказоустойчивости, так как сбой одного сервиса не приведет к полной остановке всей системы.
   - Например, если сервис уведомлений не работает, это не повлияет на основную работу системы бронирования, управления номерами и доступа.

5. **Поддержка и сопровождение**:
   - Архитектура требует хорошо организованной системы мониторинга и логирования, чтобы отслеживать состояние каждого из сервисов. Проблемы в одном сервисе могут вызвать цепную реакцию, и их нужно быстро обнаружить.
   - Каждый сервис должен быть снабжен мониторингом и системой оповещений, чтобы оперативно устранять проблемы.

### Заключение
Этот подход, несмотря на некоторую сложность в поддержке микросервисной инфраструктуры, обеспечивает высокую надежность и адаптивность системы, которая легко масштабируется и модифицируется. 
